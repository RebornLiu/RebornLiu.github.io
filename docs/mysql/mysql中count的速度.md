## mysql中count的速度

结论

- 对于myIsam引擎，如果**没有where条件** count（*）是迅速的，因为myisam引擎会记录行数，所以count并不会进行实时扫描计算。
- 对于innodb，对于count是进行实时计算。在没有二级索引的时候，count(\*)会扫描全表，速度慢；存在二级索引时count(\*)，速度会很快。

分析：

innodb的存储逻辑：

1. innodb中，主键索引与数据是存储在一起的，而二级索引（聚簇索引）保存是索引数据和主键的引用。因此对于查询数据来说，
   - 在不使用覆盖索引的前提下，使用主键索引查询直接定位数据，而使用二级索引，定位二级索引之后还要根据对应的主键索引去取数据，因此主键优于二级索引
   - 在使用覆盖索引的前提下，因为查询的数据就在二级索引中，因此不需要根据主键再次查询数据，速度很快
2. 对于count(\*) 如果只存在主键索引，实时扫描的是所有的数据文件，数据量很大，会有很多io操作，因此速度是慢的；对于存在二级索引的情况下，特别是为了count的优化，尽量采取一个小字段，查询优化器会使用该二级索引，因为数据量小，因此速度很快。

综上可以知道，对于innodb来说，count速度快慢和通常的查询有一定区别，并不仅仅是使用索引的问题，更重要的是使用不同的索引导致的扫描文件大小带来的区别